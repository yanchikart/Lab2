# Wildberries Products Database

Это репозиторий с реализацией лабораторной работы №2 по дисциплине "Управление данными". Проект представляет собой файловую базу данных для хранения информации о продуктах с платформы Wildberries. База данных реализована на Java с использованием графического интерфейса (GUI) на Swing. Работа с данными осуществляется через файлы (.dat для данных и .idx для индекса), без загрузки всей БД в память (кроме как для визуализации в таблице).

## Предметная область
База данных хранит информацию о продуктах Wildberries. Каждая запись (Product) содержит следующие поля:
- **product_id** (int, первичный ключ) — уникальный ID товара.
- **seller_id** (int) — ID продавца.
- **name** (String) — название товара.
- **price** (double) — цена.
- **brand** (String) — бренд.
- **article** (int) — артикул.
- **stock_quantity** (int) — количество на складе.
- **category** (String) — категория.
- **description** (String) — описание.

Валидация данных: положительные ID, неотрицательные цена и количество, непустые обязательные строки.

## Функции
Проект реализует все требуемые функции из задания:
- **Создание БД**: Создает новые файлы .dat и .idx.
- **Открытие БД**: Загружает индекс или восстанавливает его из .dat.
- **Сохранение БД**: Сохраняет индекс на диск.
- **Закрытие БД**: Сохраняет и закрывает файлы.
- **Очистка БД**: Удаляет все записи.
- **Удаление БД**: Удаляет файлы .dat и .idx.
- **Добавление записи**: Вставка с проверкой уникальности ключа.
- **Редактирование записи**: Обновление по ключу.
- **Удаление записи**: По ключу или по значению поля (удаляет все совпадения).
- **Поиск по полю**: По ключу (быстрый) или по другому полю (сканирование); вывод результатов в диалоге.
- **Backup**: Копирует файлы в указанную директорию.
- **Restore**: Восстанавливает из backup.
- **Экспорт в XLSX**: Выгружает все записи в Excel-файл (использует Apache POI).

GUI включает меню, кнопки, таблицу для просмотра, диалоги для ввода/поиска.

## Зависимости
- Java 8+ (тестировалось на Java 17).
- Apache POI (для экспорта в XLSX) — добавьте JAR-файлы в classpath:
  - poi-5.x.x.jar
  - poi-ooxml-5.x.x.jar
  - и зависимости (commons-collections4, xmlbeans, etc.).

## Анализ сложности алгоритмов

Реализация построена на двух файлах:
- **.dat** — последовательное хранение записей (флаг `deleted` + поля). Записи никогда не перемещаются и не перезаписываются физически.
- **.idx** — бинарный файл-индекс + `HashMap<Integer, Long>` в памяти (ключ `product_id` → смещение в .dat).

| Операция                        | Сложность по времени                  | Сложность по памяти | Комментарий |
|----------------------------------|----------------------------------------|----------------------|-------------|
| **Создание БД**                  | O(1)                                   | O(1)                | Создаются пустые файлы |
| **Открытие БД**                  | O(m) в худшем случае (если .idx нет)  | O(n)                | m — общее кол-во записей в файле (включая удалённые), n — кол-во живых записей |
| **Вставка записи (insert)**      | **O(1)** амортизированная             | O(1)                | Дописываем в конец + `HashMap.put()` |
| **Поиск по ключу (findByKey)**   | **O(1)**                               | O(1)                | `HashMap.get()` + прямой seek по смещению |
| **Обновление по ключу**          | **O(1)**                               | O(1)                | mark deleted старой + вставка новой в конец |
| **Удаление по ключу**            | **O(1)**                               | O(1)                | `HashMap.remove()` + mark deleted |
| **Поиск по не ключевому полю**   | O(m)                                   | O(k) где k — кол-во совпадений | Полное сканирование .dat |
| **Удаление по не ключевому полю**| O(m)                                   | O(1)                | Сканирование + mark deleted для всех совпадений |
| **findAll() / отображение таблицы** | O(m)                               | O(n)                | Нужно собрать все живые записи для GUI |
| **Сохранение индекса (save)**    | O(n)                                   | –                   | Запись всей HashMap в .idx |
| **Backup / Restore**             | O(размер файла)                        | –                   | Копирование файлов |
| **Экспорт в XLSX**               | O(n)                                   | O(n)                | Чтение всех живых записей + Apache POI |
